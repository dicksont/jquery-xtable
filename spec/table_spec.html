<!DOCYTYPE html>
<html>

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link href="/dist/jquery-xtable.css" rel="stylesheet"/>
  <link rel="stylesheet" href="//code.jquery.com/qunit/qunit-1.17.1.css">
  <style>
    table {
      width: 100%;
      border-collapse: collapse;
    }

    td {
      border: 1px solid #ddd;
      cursor: pointer;

    }

    ul li {
      list-style-type: none;
      display: inline-block;
    }

    ul li a {

      text-decoration: none;

    }

  </style>
  <script src="/bower_components/qunit/qunit/qunit.js"></script>
  <script>

    location.getParameterByName = function(name) {
      name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");

      var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
          results = regex.exec(this.search);

      return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
    }

    function loadBrowserScripts(scripts) {
      scripts = Array.isArray(scripts)? scripts : new Array(scripts);

      window.addEventListener('load', function() {
        for (var i=0; i < scripts.length; i++) {
          var scriptel = document.createElement('script');
          scriptel.setAttribute('src', scripts[i]);
          scriptel.async = false;
          document.body.appendChild(scriptel);
        }
      });
    }

    function waitUntil(func, cb) {
      func()? cb() : setTimeout(function() { waitUntil(func, cb) }, waitUntil.step);
    }

    waitUntil.step = 100;

    window.addEventListener('DOMContentLoaded', function() {
      var modenvel = document.getElementById('modenv');

      modenvel.value = env;

      modenvel.addEventListener('change', function() {
        window.location.href = '?env=' + modenvel.value;
      });

    });


    var env = location.getParameterByName('env');

    if (env == 'amd') {

      loadBrowserScripts('/bower_components/requirejs/require.js');
      waitUntil(function() { return window.hasOwnProperty('requirejs') }, function() {
        requirejs.config({
          urlArgs: Date.now(),
          paths: {
            'jquery' : '/jquery/dist/jquery',
            'jquery-xtable-quad' : '/src/quad',
            'jquery-xtable' : '/src/table',
            'spec' : 'table_spec',
          },
          shim: {
            'spec': {
              deps: ['jquery-xtable'],
            }
          }
        });

        requirejs(['spec']);
      });

    } else {
      loadBrowserScripts([
        "/bower_components/jquery/dist/jquery.js",
        "/src/quad.js",
        "/src/table.js",
        "table_spec.js"
      ]);
    }





  </script>


</head>

<body>

  <select id="modenv">
    <label></label>
    <option value="browser">Browser</option>
    <option value="amd">AMD [e.g. Require.js]</option>
  </select>

  <div id="qunit"></div>
  <div id="qunit-fixture">
    <table class="buster">
      <tr>
        <th>Age</th>
        <th>Games</th>
        <th>Batting Average</th>
        <th>Home Runs</th>
      </tr>
      <tr>
        <td class="selected">24</td>
        <td>45</td>
        <td>.284</td>
        <td>4</td>
      </tr>
      <tr>
        <td>25</td>
        <td>148</td>
        <td>.336</td>
        <td>24</td>
      </tr>
      <tr>
        <td>26</td>
        <td>148</td>
        <td>.294</td>
        <td>15</td>
      </tr>
      <tr>
        <td>27</td>
        <td>147</td>
        <td>.311</td>
        <td>22</td>
      </tr>
    </table>
    <table class="b">
      <tr>
        <th></th>
        <th>A</th>
        <th>B</th>
        <th>C</th>
      </tr>
      <tr>
        <th>1</th>
        <td rowspan="2" colspan="2">A1</td>
        <td>C1</td>
        <td>D1</td>
      </tr>
      <tr>
        <th>2</th>
        <td>C2</td>
        <td rowspan="2">D2</td>
      </tr>
      <tr>
        <th>3</th>
        <td>A3</td>
        <td>B3</td>
        <td>C3</td>
      </tr>
      <tr>
        <th>4</th>
        <td>A4</td>
        <td>B4</td>
        <td>C4</td>
        <td>D4</td>
      </tr>
    </table>
  </div>
</body>
</html>
